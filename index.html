<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover, shrink-to-fit=no">
    <title>‚ú® twinkle twinkle ¬∑ popmart valentine ‚ú®</title>
    <!-- 4-page mobile ¬∑ buffilo love meter + running no button + skull panda date -->
    <style>
        /* === TWINKLE TWINKLE POP MART ‚Äì MOBILE PERFECT === */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        html, body {
            width: 100%;
            min-height: 100vh;
            background: radial-gradient(circle at 30% 30%, #ffdde1, #f5b3c1);
            font-family: 'Quicksand', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 8px;
            position: relative;
            touch-action: pan-y; /* smooth vertical scroll, no zoom interference */
        }

        /* star field ‚Äì extra sparkle */
        .sparkle-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }

        .starlet {
            position: absolute;
            background: #fffce6;
            border-radius: 50%;
            box-shadow: 0 0 16px #ff9eb5;
            width: 4px;
            height: 4px;
            opacity: 0.7;
            animation: shimmer 3.5s infinite alternate;
        }

        .heart-float {
            position: absolute;
            font-size: 1.6rem;
            color: #ff8c9d;
            text-shadow: 0 0 18px #ff4d6a;
            animation: levitate 5s infinite alternate;
        }

        @keyframes shimmer {
            0% { opacity: 0.3; transform: scale(0.8); }
            100% { opacity: 1; transform: scale(1.4); background: #ffe0f0; }
        }
        @keyframes levitate {
            0% { transform: translateY(0px) rotate(0deg); }
            100% { transform: translateY(-30px) rotate(8deg); }
        }

        /* main card ‚Äì fits any small screen, soft blur */
        .valentine-card {
            max-width: 400px;
            width: 100%;
            background: rgba(255, 242, 247, 0.75);
            backdrop-filter: blur(24px);
            -webkit-backdrop-filter: blur(24px);
            border-radius: 52px 52px 52px 52px;
            border: 2px solid rgba(255, 210, 220, 0.9);
            box-shadow: 0 16px 36px rgba(180, 70, 90, 0.25), inset 0 0 40px #ffe2ec;
            padding: 28px 20px;
            position: relative;
            z-index: 10;
            transition: all 0.2s;
        }

        .page {
            display: none;
            flex-direction: column;
            align-items: center;
            width: 100%;
        }

        .page.active {
            display: flex;
        }

        /* twinkle character */
        .twinkle-emoji {
            font-size: 5.4rem;
            line-height: 1;
            filter: drop-shadow(0 8px 14px #ff6b8b);
            margin-bottom: 4px;
        }

        h2, .question-big {
            font-size: 2rem;
            font-weight: 800;
            color: #57202c;
            text-shadow: 0 4px 8px #fff0f5;
            text-align: center;
            margin: 8px 0 4px;
            word-break: break-word;
        }

        .buffalo-highlight {
            background: #ffb6c1c0;
            padding: 8px 24px;
            border-radius: 60px;
            font-size: 2rem;
            color: #39171e;
            border: 3px solid white;
            margin: 12px 0;
        }

        /* LOVE SLIDER ‚Äì big thumb for fat fingers */
        .slider-container {
            width: 100%;
            margin: 32px 0 24px;
        }

        .love-meter {
            width: 100%;
            height: 22px;
            -webkit-appearance: none;
            appearance: none;
            background: linear-gradient(to right, #ffb3c1, #ff4d6a);
            border-radius: 40px;
            outline: none;
            border: 3px solid white;
            box-shadow: 0 2px 12px #c06676;
        }

        .love-meter::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 56px;
            height: 56px;
            background: #fff2f5;
            border: 5px solid #e6324e;
            border-radius: 50%;
            box-shadow: 0 6px 0 #811f31, 0 10px 28px #b32e4a;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23d62839"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>');
            background-size: 58%;
            background-position: center 55%;
            background-repeat: no-repeat;
            cursor: pointer;
        }

        .percent-box {
            font-size: 3.2rem;
            font-weight: 900;
            color: #ad1f36;
            background: #fff6f9ee;
            padding: 8px 32px;
            border-radius: 80px;
            display: inline-block;
            border: 3px solid #ffa5b9;
            margin-top: 10px;
            text-shadow: 0 0 10px white;
        }

        /* cheeky twinkle message */
        .feedback-msg {
            background: #fff1f5f0;
            border: 4px dashed #ff6b8b;
            border-radius: 60px;
            padding: 16px 18px;
            font-size: 1.5rem;
            color: #4a1e28;
            margin: 12px 0 0;
            width: 100%;
            text-align: center;
            backdrop-filter: blur(4px);
            font-weight: 600;
        }

        .btn {
            background: #ff879a;
            border: none;
            padding: 16px 20px;
            font-size: 2rem;
            font-weight: 700;
            border-radius: 80px;
            color: white;
            text-shadow: 0 3px 0 #922436;
            box-shadow: 0 10px 0 #6a2832, 0 14px 28px #ff99aa;
            border: 3px solid #ffeef0;
            margin-top: 28px;
            width: 100%;
            letter-spacing: 3px;
            transition: 0.06s;
            cursor: pointer;
            -webkit-appearance: none;
        }

        .btn:active {
            transform: translateY(8px);
            box-shadow: 0 2px 0 #6a2832, 0 16px 32px #ffa5b9;
        }

        /* page 3 ‚Äì yes + no (no runs away) */
        .button-pair {
            position: relative;
            width: 100%;
            min-height: 140px;
            margin: 24px 0 12px;
        }

        .yes-fixed {
            position: absolute;
            left: 0%;
            top: 10px;
            width: 45%;
            z-index: 25;
        }

        .btn-yes {
            background: #ffa5b9;
            color: #381c22;
            font-size: 2rem;
            padding: 16px 8px;
            width: 100%;
            border: 4px solid white;
            border-radius: 60px;
            box-shadow: 0 10px 0 #913a47;
            font-weight: bold;
        }

        .no-mobile-wrapper {
            position: absolute;
            width: 45%;
            pointer-events: auto;
            transition: left 0.2s ease, top 0.2s ease;
            z-index: 30;
            left: 55%;
            top: 10px;
        }

        .btn-no {
            background: #a69c9c;
            color: #2c1b1d;
            font-size: 2rem;
            padding: 16px 8px;
            width: 100%;
            border: 4px solid #e6d3d3;
            border-radius: 60px;
            box-shadow: 0 10px 0 #584344;
            pointer-events: none;  /* no direct clicks */
            font-weight: bold;
        }

        /* invitation card ‚Äì cute details */
        .invite-box {
            background: #fff3f7f2;
            border-radius: 44px;
            padding: 24px 20px;
            width: 100%;
            border: 6px solid #ffb3c6;
            box-shadow: inset 0 0 28px #ffe5ec;
            margin-top: 20px;
        }

        .invite-head {
            font-size: 2rem;
            color: #691c2a;
            font-weight: 800;
        }

        .venue-item {
            background: white;
            border-radius: 60px;
            padding: 16px 20px;
            margin: 16px 0;
            font-size: 1.6rem;
            display: flex;
            align-items: center;
            gap: 12px;
            border: 3px solid #ff8da1;
            font-weight: 600;
        }

        /* responsive tweaks */
        @media (max-width: 380px) {
            .valentine-card { padding: 20px 16px; }
            h2 { font-size: 1.8rem; }
            .btn { font-size: 1.8rem; }
        }

        /* extra utility */
        .text-glow { text-shadow: 0 0 18px #ffe6f0; }
    </style>
</head>
<body>

<!-- sparkle overlay (pure css, lightweight) -->
<div class="sparkle-bg" id="sparkleBg"></div>

<!-- main card -->
<div class="valentine-card">

    <!-- ========== PAGE 1 ‚Äì LOVE METER (0-100) ========= -->
    <div id="page1" class="page active">
        <div class="twinkle-emoji">‚ú®üêÉ‚ú®</div>
        <h2>how much do you love</h2>
        <span class="buffalo-highlight">BUFFILO ?</span>
        
        <div class="slider-container">
            <input type="range" id="loveSlider" class="love-meter" min="0" max="100" value="44" step="1">
            <div style="display: flex; justify-content: center; align-items: baseline;">
                <span id="lovePercent" class="percent-box">44</span>
                <span style="font-size: 3rem; margin-left: 6px;">‚ù§Ô∏è</span>
            </div>
        </div>

        <div id="sadMessage" class="feedback-msg">
            üíî slide to 100, only 100 is real love!
        </div>

        <button id="confirmLove" class="btn">‚ú® CONFIRM ‚ú®</button>
    </div>

    <!-- ========== PAGE 2 ‚Äì I KNEW IT! ========= -->
    <div id="page2" class="page">
        <div class="twinkle-emoji">üòé‚ú®üíØ</div>
        <h2 style="font-size: 2.8rem;">I KNEW IT!</h2>
        <div style="font-size: 2.4rem; background: #ffd9e2; padding: 10px 30px; border-radius: 60px; margin: 24px 0; border: 4px solid white;">
            üíï 100% buffilo love üíï
        </div>
        <div style="font-size: 2.4rem;">‚ú®üíñ‚ú®</div>
        <button id="goToProposal" class="btn">üíò NEXT üíò</button>
    </div>

    <!-- ========== PAGE 3 ‚Äì WILL YOU BE MY VALENTINE? (no runs) ========= -->
    <div id="page3" class="page">
        <div style="font-size: 5rem;">ü•∫üíò</div>
        <h2 style="font-size: 2rem; margin-top: 4px;">will you be my valentines?</h2>
        <div style="font-size: 2.8rem;">‚ú®üíå‚ú®</div>

        <!-- yes + no container (mobile-optimized fleeing) -->
        <div class="button-pair">
            <!-- YES button ‚Äì left side -->
            <div class="yes-fixed">
                <button id="yesButton" class="btn-yes">üíñ YES</button>
            </div>
            <!-- NO wrapper ‚Äì runs away -->
            <div id="noWrapperMobile" class="no-mobile-wrapper">
                <button id="noButton" class="btn-no">üíî no</button>
            </div>
        </div>

        <div style="margin-top: 140px; background: #ffeef2e0; padding: 16px; border-radius: 60px; font-size: 1.4rem; color: #5c2a33; width: 100%; text-align: center; backdrop-filter: blur(4px); border: 2px solid #ffb3c6;">
            ‚≠ê the 'no' is shy ‚Ä¶ it runs away! ‚≠ê
        </div>
    </div>

    <!-- ========== PAGE 4 ‚Äì VALENTINE INVITATION (KAFE UTU + SKULL PANDA) ========= -->
    <div id="page4" class="page">
        <div style="font-size: 4.6rem;">üéâ‚ú®üíñ</div>
        <h2 style="font-size: 2.2rem; margin-bottom: 8px;">YOU SAID YES!</h2>
        <div class="invite-box">
            <div class="invite-head">üíå YOU'RE INVITED üíå</div>
            <div class="venue-item">
                <span style="font-size: 2.8rem;">‚òï</span> KAFE UTU ¬∑ coffee date
            </div>
            <div class="venue-item">
                <span style="font-size: 2.8rem;">üêº</span> SKULL PANDA exhibition
            </div>
            <div style="background: #ffccd5; border-radius: 60px; padding: 16px; font-size: 1.7rem; margin-top: 12px; border: 3px solid #ff6b7f;">
                üíò feb 14 ¬∑ 3pm üíò<br><span style="font-size: 1.3rem;">bring your twinkle self!</span>
            </div>
        </div>
        <div style="margin-top: 20px; font-size: 2.6rem;">‚ú®üêÉ‚ú®</div>
    </div>
</div>

<script>
    (function(){
        "use strict";

        // --- TWINKLE BACKGROUND (mobile friendly, less nodes) ---
        function createSparkles() {
            const bg = document.getElementById('sparkleBg');
            bg.innerHTML = '';
            for (let i=0;i<48;i++) {
                let star = document.createElement('div');
                star.className = 'starlet';
                star.style.left = Math.random()*100 + '%';
                star.style.top = Math.random()*100 + '%';
                star.style.width = (Math.random()*9+3)+'px';
                star.style.height = star.style.width;
                star.style.animationDelay = (Math.random()*4)+'s';
                bg.appendChild(star);
            }
            for (let i=0;i<18;i++) {
                let h = document.createElement('div');
                h.className = 'heart-float';
                h.innerHTML = ['‚ú®','üíñ','üêÉ','üå∏','üíò','‚≠ê','üß∏'][Math.floor(Math.random()*7)];
                h.style.left = Math.random()*100+'%';
                h.style.top = Math.random()*100+'%';
                h.style.fontSize = (Math.random()*22+18)+'px';
                h.style.animationDelay = (Math.random()*5)+'s';
                bg.appendChild(h);
            }
        }
        createSparkles();

        // --- PAGE CONTROL ---
        const p1 = document.getElementById('page1');
        const p2 = document.getElementById('page2');
        const p3 = document.getElementById('page3');
        const p4 = document.getElementById('page4');

        function show(page) {
            p1.classList.remove('active');
            p2.classList.remove('active');
            p3.classList.remove('active');
            p4.classList.remove('active');
            page.classList.add('active');
        }

        // --- PAGE 1 SLIDER + 100% VALIDATION ---
        const slider = document.getElementById('loveSlider');
        const percentSpan = document.getElementById('lovePercent');
        const sadEl = document.getElementById('sadMessage');
        const confirmBtn = document.getElementById('confirmLove');

        function updateSlider() {
            percentSpan.innerText = slider.value;
        }
        slider.addEventListener('input', updateSlider);
        updateSlider();

        confirmBtn.addEventListener('click', function(e){
            e.preventDefault();
            let val = parseInt(slider.value,10);
            if (val === 100) {
                show(p2);
            } else {
                // sad cheeky twinkle
                let msgs = [
                    'üò¢ only 100 is buffilo love!', 
                    'üíî twinkle is sad ‚Ä¶ slide to 100!',
                    'üêÉ buffilo wants 100, not '+val+'!',
                    'ü•∫ cheeky! try again (100 only)',
                    '‚ú® 100% or nothing! ‚ú®'
                ];
                sadEl.innerHTML = 'üíß sad twinkle ¬∑ ' + msgs[Math.floor(Math.random() * msgs.length)];
                // vibrate if supported (optional, just for fun)
                if (navigator.vibrate) navigator.vibrate(20);
            }
        });

        // --- PAGE 2: next button ---
        document.getElementById('goToProposal').addEventListener('click', function(){
            show(p3);
            // reset fleeing button position when page 3 appears
            moveNoButton(true);
        });

        // --- PAGE 3: EVASIVE NO BUTTON (works perfectly on phone) ---
        const noWrapper = document.getElementById('noWrapperMobile');
        const noBtn = document.getElementById('noButton');
        const yesBtn = document.getElementById('yesButton');

        // ensure no button itself is unclickable
        noBtn.style.pointerEvents = 'none';
        // wrapper captures all pointer events
        noWrapper.style.pointerEvents = 'auto';

        // function to move no button to random location within .button-pair
        function moveNoButton(force = false) {
            if (!p3.classList.contains('active')) return;
            const parentDiv = document.querySelector('.button-pair');
            if (!parentDiv || !noWrapper) return;

            const parentRect = parentDiv.getBoundingClientRect();
            const wrapperRect = noWrapper.getBoundingClientRect();

            // relative to parent (position absolute)
            const maxLeft = parentRect.width - wrapperRect.width - 12;
            const maxTop = parentRect.height - wrapperRect.height - 12;

            let newLeft = Math.random() * maxLeft;
            // avoid YES region: keep away from left 0-45% area
            while (newLeft < parentRect.width * 0.42 && newLeft > 10) {
                newLeft = Math.random() * maxLeft;
            }
            let newTop = Math.random() * maxTop;
            if (newTop < 5) newTop = 20;
            if (newTop > maxTop) newTop = maxTop - 10;
            
            noWrapper.style.left = newLeft + 'px';
            noWrapper.style.top = newTop + 'px';
        }

        // flee from touch or mouse (proximity)
        function fleeHandler(e) {
            if (!p3.classList.contains('active')) return;
            let clientX, clientY;
            if (e.touches) {
                clientX = e.touches[0].clientX;
                clientY = e.touches[0].clientY;
            } else {
                clientX = e.clientX;
                clientY = e.clientY;
            }

            const noRect = noWrapper.getBoundingClientRect();
            const centerX = noRect.left + noRect.width/2;
            const centerY = noRect.top + noRect.height/2;
            const dist = Math.hypot(clientX - centerX, clientY - centerY);
            if (dist < 150) { // flee radius
                moveNoButton();
            }
        }

        // click on wrapper = flee (no click possible)
        function fleeOnTouchClick(e) {
            e.preventDefault();
            e.stopPropagation();
            if (p3.classList.contains('active')) {
                moveNoButton();
                // mini effect
                noWrapper.style.transform = 'scale(0.9)';
                setTimeout(() => noWrapper.style.transform = 'scale(1)', 120);
            }
            return false;
        }

        // attach listeners
        document.addEventListener('mousemove', fleeHandler);
        document.addEventListener('touchmove', fleeHandler, { passive: false });

        if (noWrapper) {
            noWrapper.addEventListener('click', fleeOnTouchClick);
            noWrapper.addEventListener('touchstart', fleeOnTouchClick, { passive: false });
        }

        // YES button -> page 4
        yesBtn.addEventListener('click', function(e){
            e.preventDefault();
            show(p4);
        });

        // reposition on orientation/resize
        window.addEventListener('resize', function() {
            if (p3.classList.contains('active')) moveNoButton();
        });

        // initial move when page 3 loads
        window.addEventListener('load', function() {
            setTimeout(() => { if (p3.classList.contains('active')) moveNoButton(); }, 50);
        });
        setTimeout(() => { if (p3.classList.contains('active')) moveNoButton(); }, 80);

        // --- PAGE 4 no further action ---

        // --- block zoom on buttons for Telegram WebView ---
        const allInteractive = document.querySelectorAll('.btn, .btn-yes, .btn-no, .love-meter');
        allInteractive.forEach(el => {
            el.addEventListener('touchstart', (e) => {
                e.preventDefault(); // prevents double-tap zoom
            }, { passive: false });
        });

        // special: make slider work without zoom
        const sliderTouch = document.getElementById('loveSlider');
        sliderTouch.addEventListener('touchstart', (e) => { e.stopPropagation(); }, { passive: true });

    })();
</script>

<!-- extra guarantee: no pointer events on no button -->
<style>
    #noButton { pointer-events: none !important; }
    .no-mobile-wrapper { pointer-events: auto; touch-action: pan-y; }
    .button-pair { touch-action: pan-y; }
    /* huge hit area */
    .btn-yes, .btn-no { min-height: 80px; display: flex; align-items: center; justify-content: center; }
    /* no pull-to-refresh interference inside card */
    .valentine-card { touch-action: pan-y; }
</style>

</body>
</html>
