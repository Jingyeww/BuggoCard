<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>‚ú® twinkle twinkle ¬∑ popmart valentine ‚ú®</title>
    <!-- 4 pages: love meter, i knew it, proposal, date invite ¬∑ buffilo & twinkle -->
    <style>
        /* ===== TWINKLE TWINKLE POP MART ¬∑ VALENTINE ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background: radial-gradient(circle at top, #ffdde1, #ee9ca7);
            font-family: 'Quicksand', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            min-height: 100dvh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 16px;
            position: relative;
            overflow-x: hidden;
            transition: background 0.3s ease;
        }

        /* twinkle theme ‚Äì stars, sparkle */
        .twinkle-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }

        .star {
            position: absolute;
            background: #fffde7;
            border-radius: 50%;
            box-shadow: 0 0 12px #ffb7c5;
            width: 4px;
            height: 4px;
            opacity: 0.7;
            animation: floatStar 4s infinite alternate;
        }

        .mini-heart {
            position: absolute;
            font-size: 1.4rem;
            color: #ff8c9d;
            text-shadow: 0 0 12px #ff4f6b;
            animation: heartbeat 3s infinite;
            user-select: none;
        }

        @keyframes floatStar {
            0% { transform: translateY(0px) scale(1); opacity: 0.4; }
            100% { transform: translateY(-25px) scale(1.2); opacity: 1; }
        }
        @keyframes heartbeat {
            0% { transform: scale(0.9); opacity: 0.6; }
            100% { transform: scale(1.2); opacity: 0.9; }
        }

        /* main container = phone card */
        .phone-frame {
            max-width: 420px;
            width: 100%;
            background: rgba(255, 240, 245, 0.7);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 48px 48px 48px 48px;
            border: 2px solid rgba(255, 220, 240, 0.8);
            box-shadow: 0 20px 40px rgba(200, 80, 100, 0.25), inset 0 0 40px rgba(255, 220, 240, 0.6);
            padding: 28px 20px;
            position: relative;
            z-index: 10;
            transition: all 0.2s;
        }

        /* pages ‚Äì only 1 visible at a time */
        .page {
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 100%;
        }

        .page.active {
            display: flex;
        }

        /* twinkle character */
        .twinkle-icon {
            font-size: 5rem;
            line-height: 1;
            margin-bottom: 0.2rem;
            filter: drop-shadow(0 8px 12px #ff99aa);
            animation: twinklePop 2s infinite;
        }
        @keyframes twinklePop {
            0% { transform: scale(1); }
            50% { transform: scale(1.08); }
        }

        h2, .question {
            font-size: 1.9rem;
            font-weight: 700;
            color: #5e2e3c;
            text-shadow: 0 2px 8px #ffe0f0;
            text-align: center;
            margin: 12px 0 8px;
            letter-spacing: 2px;
        }

        .buffalo-name {
            font-size: 2rem;
            background: #ffb6c180;
            display: inline-block;
            padding: 0 16px;
            border-radius: 60px;
            color: #3f1e26;
        }

        /* slider love meter */
        .slider-box {
            width: 100%;
            margin: 30px 0 20px;
        }

        .love-slider {
            width: 100%;
            height: 16px;
            -webkit-appearance: none;
            appearance: none;
            background: linear-gradient(to right, #ffb6c1, #ff4d6d);
            border-radius: 30px;
            outline: none;
            border: 2px solid white;
        }

        .love-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 38px;
            height: 38px;
            background: #ffe5f0;
            border: 3px solid #ff1e4d;
            border-radius: 50%;
            box-shadow: 0 4px 12px #b32e4a;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23ff1e4d"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>');
            background-size: 60%;
            background-position: center 55%;
            background-repeat: no-repeat;
            cursor: pointer;
            transition: 0.1s;
        }

        .slider-value {
            font-size: 2.8rem;
            font-weight: 800;
            color: #b32e4a;
            text-shadow: 0 0 20px white;
            margin-top: 10px;
            background: #fff0f3c0;
            padding: 6px 20px;
            border-radius: 60px;
            display: inline-block;
            border: 2px solid #ffb3c6;
        }

        .btn {
            background: #ff8c9d;
            border: none;
            padding: 16px 32px;
            font-size: 1.8rem;
            font-weight: bold;
            border-radius: 60px;
            color: white;
            text-shadow: 0 2px 0 #a1334a;
            box-shadow: 0 8px 0 #712c38, 0 12px 28px #ff99aa;
            border: 2px solid #ffe6ec;
            margin-top: 20px;
            width: 100%;
            letter-spacing: 4px;
            transition: 0.08s;
            font-family: inherit;
            cursor: pointer;
        }

        .btn:active {
            transform: translateY(6px);
            box-shadow: 0 2px 0 #712c38, 0 12px 28px #ffa5b9;
        }

        /* sad twinkle / cheeky message */
        .cheeky-msg {
            background: #ffe8f0dd;
            padding: 16px;
            border-radius: 60px;
            font-size: 1.5rem;
            color: #661c28;
            border: 3px dashed #ff6b8b;
            margin: 12px 0;
            text-align: center;
            backdrop-filter: blur(6px);
            width: 100%;
        }

        /* no button wrapper ‚Äì escape artist */
        .btn-wrapper {
            position: relative;
            width: 100%;
            display: flex;
            justify-content: center;
            margin-top: 20px;
            min-height: 88px;
        }

        .btn-yes, .btn-no {
            font-size: 2rem;
            padding: 16px 32px;
            border-radius: 60px;
            border: 3px solid white;
            font-weight: bold;
            box-shadow: 0 8px 0 #712c38;
            transition: 0.05s;
            width: auto;
            min-width: 160px;
        }

        .btn-yes {
            background: #ffb3c6;
            color: #3a1e26;
            box-shadow: 0 8px 0 #993b4a;
            border: 3px solid #ffeef2;
        }

        .btn-no {
            background: #b0a4a4;
            color: #2f1e20;
            box-shadow: 0 8px 0 #5f4a4d;
            border: 3px solid #ddd;
            pointer-events: none; /* core: no click */
        }

        .no-wrapper {
            position: absolute;
            pointer-events: auto;
            transition: left 0.18s ease-out, top 0.18s ease-out;
            left: 55%;
            top: 0;
        }

        /* invitation card */
        .invite-card {
            background: #ffecf0f0;
            border-radius: 36px;
            padding: 24px;
            width: 100%;
            border: 6px solid #ffb3c6;
            box-shadow: inset 0 0 30px #ffe0e8;
            margin-top: 12px;
        }

        .invite-title {
            font-size: 2rem;
            color: #601f2b;
        }

        .spot-detail {
            background: #ffffffb0;
            border-radius: 40px;
            padding: 14px;
            margin: 12px 0;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
            border: 2px solid #ff8095;
        }

        /* responsive */
        @media (max-width: 380px) {
            .phone-frame { padding: 20px 14px; }
            h2 { font-size: 1.7rem; }
            .btn { font-size: 1.6rem; }
        }

        .hidden { display: none; }
        .buff-icon { font-size: 3.4rem; }
    </style>
</head>
<body>

<div class="twinkle-bg" id="twinkleBg"></div>

<div class="phone-frame">
    <!-- ========== PAGE 1 : LOVE METER 0‚Äì100 ========= -->
    <div id="page1" class="page active">
        <div class="twinkle-icon">‚ú®ü•∫‚ú®</div>
        <h2 style="font-size:2rem;">how much do you love</h2>
        <div class="buffalo-name">üêÉ BUFFILO? üêÉ</div>
        
        <div class="slider-box">
            <input type="range" id="loveSlider" class="love-slider" min="0" max="100" value="50" step="1">
            <div style="display: flex; justify-content: center; margin-top: 8px;">
                <span id="sliderDisplay" class="slider-value">50</span><span style="font-size:2.4rem; margin-left:4px;">‚ù§Ô∏è</span>
            </div>
        </div>

        <div id="cheekyMessage" class="cheeky-msg" style="background: #fff0f3e0;">‚ú® only 100 is real love! ‚ú®</div>

        <button id="confirmLoveBtn" class="btn">üíó CONFIRM üíó</button>
    </div>

    <!-- ========== PAGE 2 : I KNEW IT! ========= -->
    <div id="page2" class="page">
        <div class="twinkle-icon" style="font-size:6rem;">üòé‚ú®</div>
        <h2 style="font-size:2.6rem; margin-bottom: 0;">I KNEW IT!</h2>
        <div style="font-size:2rem; margin: 16px 0; color:#80223b;">üíØ 100% Buffilo love üíØ</div>
        <div style="display: flex; gap: 8px; justify-content: center; font-size:2rem;">
            <span>‚ú®</span><span>üíò</span><span>‚ú®</span>
        </div>
        <button id="nextToProposeBtn" class="btn" style="margin-top: 40px;">üíï NEXT üíï</button>
    </div>

    <!-- ========== PAGE 3 : WILL YOU BE MY VALENTINE? ========= -->
    <div id="page3" class="page">
        <div style="font-size:4rem; margin-bottom: 4px;">ü•∫üíñ</div>
        <h2 style="font-size:2rem; line-height:1.3;">will you be my valentines?</h2>
        <div style="display: flex; justify-content: center; align-items: center; gap: 8px; font-size: 2.6rem;">‚ú®üíå‚ú®</div>
        
        <!-- YES + NO (no button runs away) -->
        <div style="position: relative; width: 100%; min-height: 130px; display: flex; justify-content: center; align-items: center; margin-top: 24px;">
            <!-- YES button static left side -->
            <div style="position: absolute; left: 5%; top: 20px; width: 40%;">
                <button id="yesValentineBtn" class="btn-yes" style="width:100%;">üíñ YES</button>
            </div>
            <!-- NO button wrapper ‚Äì fleeing -->
            <div id="fleeWrapper" class="no-wrapper" style="position: absolute; left: 55%; top: 20px; width: 40%;">
                <button id="noValentineBtn" class="btn-no" style="width:100%; pointer-events: none;">üíî no</button>
            </div>
        </div>
        <div style="margin-top: 100px; color: #7a3642; background: #ffeef2; padding: 14px; border-radius: 60px; font-size:1.3rem; width:100%; text-align:center;">
            ‚≠ê the 'no' is shy ... keeps running! ‚≠ê
        </div>
    </div>

    <!-- ========== PAGE 4 : DATE INVITATION ========= -->
    <div id="page4" class="page">
        <div class="twinkle-icon">üéâ‚ú®üíò</div>
        <h2 style="font-size:2.2rem;">YOU SAID YES!</h2>
        <div style="font-size:2rem; margin-bottom: 12px;">üíû twinkle valentine üíû</div>

        <div class="invite-card">
            <div style="display:flex; justify-content:center; gap:16px; font-size:2.4rem;">üßâ üçõ üß∏</div>
            <div class="invite-title">üíå YOU'RE INVITED üíå</div>
            <div class="spot-detail">
                <span style="font-size:2.5rem;">‚òï</span> KAFE UTU ¬∑ coffee date
            </div>
            <div class="spot-detail">
                <span style="font-size:2.5rem;">üêº</span> SKULL PANDA exhibition
            </div>
            <div style="margin: 16px 0 0; font-size:1.7rem; background: #ffd9e2; padding: 12px; border-radius: 30px;">
                üíï feb 14 ¬∑ 3pm üíï<br> <span style="font-size:1.3rem;">bring your twinkle self!</span>
            </div>
        </div>
        <div style="margin-top: 20px; font-size: 2rem;">‚ú®üíñüêÉ‚ú®</div>
    </div>
</div>

<script>
    (function() {
        "use strict";

        // ---------- üåü GENERATE TWINKLE STARS ----------
        function generateTwinkles() {
            const bg = document.getElementById('twinkleBg');
            bg.innerHTML = '';
            for (let i = 0; i < 55; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.width = Math.random() * 8 + 3 + 'px';
                star.style.height = star.style.width;
                star.style.animationDelay = Math.random() * 3 + 's';
                bg.appendChild(star);
            }
            for (let i = 0; i < 20; i++) {
                const heart = document.createElement('div');
                heart.className = 'mini-heart';
                heart.innerHTML = ['‚ú®','üíñ','üå∏','üêÉ','‚≠ê','üíò','üíó'][Math.floor(Math.random() * 7)];
                heart.style.left = Math.random() * 100 + '%';
                heart.style.top = Math.random() * 100 + '%';
                heart.style.fontSize = (Math.random() * 20 + 18) + 'px';
                heart.style.animationDuration = (Math.random() * 4 + 3) + 's';
                bg.appendChild(heart);
            }
        }
        generateTwinkles();

        // ---------- PAGE CONTROL ----------
        const page1 = document.getElementById('page1');
        const page2 = document.getElementById('page2');
        const page3 = document.getElementById('page3');
        const page4 = document.getElementById('page4');

        function showPage(page) {
            page1.classList.remove('active');
            page2.classList.remove('active');
            page3.classList.remove('active');
            page4.classList.remove('active');
            page.classList.add('active');
        }

        // ---------- PAGE 1: SLIDER + 100% VALIDATION ----------
        const slider = document.getElementById('loveSlider');
        const sliderDisplay = document.getElementById('sliderDisplay');
        const cheekyMsg = document.getElementById('cheekyMessage');
        const confirmBtn = document.getElementById('confirmLoveBtn');

        // update slider number
        function updateSliderVal() {
            const val = slider.value;
            sliderDisplay.innerText = val;
        }
        slider.addEventListener('input', updateSliderVal);
        updateSliderVal();

        // confirm love: only 100 passes
        confirmBtn.addEventListener('click', function() {
            const loveValue = parseInt(slider.value, 10);
            if (loveValue === 100) {
                // go to page 2 "I KNEW IT!"
                showPage(page2);
            } else {
                // cheeky sad twinkle message
                const sadMessages = [
                    'üò¢ only 100% counts! buffilo cries...',
                    'üíî that\'s not enough! try 100!',
                    'üêÉ buffilo wants 100 love!',
                    '‚ú® twinkle says: must be 100 ‚ú®',
                    'ü•∫ cheeky! slide to 100!'
                ];
                cheekyMsg.innerHTML = 'üíß sad twinkle ¬∑ ' + sadMessages[Math.floor(Math.random() * sadMessages.length)];
                // also shake slider?
                slider.style.transform = 'scale(0.98)';
                setTimeout(() => slider.style.transform = 'scale(1)', 120);
            }
        });

        // ---------- PAGE 2: NEXT BUTTON -> PAGE 3 (PROPOSAL) ----------
        document.getElementById('nextToProposeBtn').addEventListener('click', function() {
            showPage(page3);
            // reset fleeing button position when page 3 shows
            repositionNoButton(true); 
        });

        // ---------- PAGE 3: EVASIVE NO BUTTON (mobile optimized) + YES ----------
        const fleeWrapper = document.getElementById('fleeWrapper');
        const noBtn = document.getElementById('noValentineBtn');
        const yesBtn = document.getElementById('yesValentineBtn');

        // ensure no button itself is unclickable
        if (noBtn) { noBtn.style.pointerEvents = 'none'; }

        // function to move no button to random spot inside container (phone-frame)
        function repositionNoButton(force = false) {
            if (!fleeWrapper || !page3.classList.contains('active')) return;

            const container = document.querySelector('.phone-frame');
            if (!container) return;

            const containerRect = container.getBoundingClientRect();
            const wrapperRect = fleeWrapper.getBoundingClientRect();

            // boundaries: stay inside phone-frame, but avoid yes button area (left side)
            const maxLeft = containerRect.width - wrapperRect.width - 20;
            const maxTop = containerRect.height - wrapperRect.height - 20;

            // generate random but keep away from left 40% (where YES lives)
            let newLeft = Math.random() * maxLeft;
            while (newLeft < containerRect.width * 0.35 && newLeft > containerRect.width * 0.05) {
                newLeft = Math.random() * maxLeft;   // avoid YES region
            }
            let newTop = Math.random() * maxTop;
            // keep inside bounds
            newLeft = Math.min(Math.max(newLeft, 10), maxLeft);
            newTop = Math.min(Math.max(newTop, 10), maxTop);

            fleeWrapper.style.left = newLeft + 'px';
            fleeWrapper.style.top = newTop + 'px';
        }

        // flee from touch / mouse (proximity)
        function handleFlee(e) {
            if (!page3.classList.contains('active')) return;
            if (!fleeWrapper) return;

            let clientX, clientY;
            if (e.touches) {
                clientX = e.touches[0].clientX;
                clientY = e.touches[0].clientY;
            } else {
                clientX = e.clientX;
                clientY = e.clientY;
            }

            const noRect = fleeWrapper.getBoundingClientRect();
            const centerX = noRect.left + noRect.width / 2;
            const centerY = noRect.top + noRect.height / 2;

            const distance = Math.hypot(clientX - centerX, clientY - centerY);
            if (distance < 140) {  // flee zone
                repositionNoButton();
            }
        }

        // also flee on click/tap on wrapper (since button unclickable)
        function fleeOnClickWrapper(e) {
            e.preventDefault();
            e.stopPropagation();
            if (page3.classList.contains('active')) {
                repositionNoButton();
                // micro scale fun
                fleeWrapper.style.transform = 'scale(0.9)';
                setTimeout(() => fleeWrapper.style.transform = 'scale(1)', 120);
            }
            return false;
        }

        // attach listeners only when page3 active
        document.addEventListener('mousemove', handleFlee);
        document.addEventListener('touchmove', handleFlee, { passive: false });
        // wrapper click = runaway
        if (fleeWrapper) {
            fleeWrapper.addEventListener('click', fleeOnClickWrapper);
            fleeWrapper.addEventListener('touchstart', fleeOnClickWrapper, { passive: false });
        }

        // YES button -> page4
        yesBtn.addEventListener('click', function() {
            showPage(page4);
        });

        // reposition on page 3 show and orientation change
        window.addEventListener('resize', function() {
            if (page3.classList.contains('active')) repositionNoButton();
        });

        // ---------- PAGE 4: no action needed, invitation visible ----------

        // additional: if someone taps wildly, flee
        // also ensure initial position for page 3
        window.addEventListener('load', function() {
            setTimeout(() => { if (page3.classList.contains('active')) repositionNoButton(); }, 30);
        });

        // for telegram / phone ‚Äî prevent zoom on slider & buttons
        const allBtns = document.querySelectorAll('.btn, .btn-yes, .btn-no');
        allBtns.forEach(btn => {
            btn.addEventListener('touchstart', (e) => {
                e.preventDefault();  // no double tap zoom
            }, { passive: false });
        });

        // also on slider, prevent page zoom
        slider.addEventListener('touchstart', (e) => { e.stopPropagation(); }, { passive: true });

        // ensure wrapper doesn't overflow
        // manual call after transition
        setTimeout(() => { repositionNoButton(true); }, 100);
    })();
</script>

<!-- extra safety: pointer-events none on no-btn -->
<style>
    #noValentineBtn { pointer-events: none !important; }
    .no-wrapper { pointer-events: auto; }
    .btn, .btn-yes, .btn-no { cursor: pointer; }
    .btn-yes:active { transform: translateY(6px); box-shadow: 0 2px 0 #993b4a; }
    /* mobile optimization */
    .phone-frame { touch-action: pan-y; }
    input[type=range] { touch-action: none; }
</style>

</body>
</html>